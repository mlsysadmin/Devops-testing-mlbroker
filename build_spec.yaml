version: 0.2

phases:
  install:
    runtime-versions:
      docker: 18.09.0
    commands:
      - echo Installing dependencies...
      - pip install -r backend/requirements.txt
  build:
    commands:
      - echo Building backend...
      - cd backend
      - docker build -t backend .
      - cd ..
      - echo Building frontend...
      - cd frontend
      - docker build -t frontend .
      - cd ..
  post_build:
    commands:
      - echo Pushing images to ECR...
      - docker push backend
      - docker push frontend

artifacts:
  files:
    - backend/Dockerfile
    - frontend/Dockerfile
